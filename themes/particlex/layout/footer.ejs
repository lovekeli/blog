<script>
    function timeDifference(timeStr) {
        // 将输入的时间字符串转换为 Date 对象
        const targetDate = new Date(timeStr);
        if (isNaN(targetDate.getTime())) {
            throw new Error('无效的时间格式，支持的格式如: "YYYY-MM-DD HH:mm:ss"');
        }

        // 获取当前时间
        const now = new Date();

        // 计算年差
        let years = now.getFullYear() - targetDate.getFullYear();

        // 计算月差
        let months = now.getMonth() - targetDate.getMonth();

        // 计算日差
        let days = now.getDate() - targetDate.getDate();

        // 如果月份或日期不够减，则向前借位
        if (days < 0) {
            // 获取上个月的天数
            const prevMonthLastDay = new Date(
                now.getFullYear(),
                now.getMonth(),
                0
            ).getDate();
            days += prevMonthLastDay;
            months--;
        }

        if (months < 0) {
            months += 12;
            years--;
        }

        // 处理目标日期在未来的情况
        if (years < 0) {
            years = Math.abs(years);
            months = 11 - months;
            days = new Date(
                targetDate.getFullYear(),
                targetDate.getMonth() + 1,
                0
            ).getDate() - days;

            if (days > 0) {
                months++;
            }

            if (months >= 12) {
                years++;
                months %= 12;
            }
        }

        // 构建结果字符串
        return `${years}年${months}月${days}天`;
    }
    document.addEventListener("DOMContentLoaded",  ()=> {
        document.getElementById('runTime').innerText = this.timeDifference("<%=theme.footer.starttime %>"); 
    });
</script>
<footer id="footer">
    <div id="footer-wrap">
        <!-- <div>
            &copy;
            <%= theme.footer.since %> - <%= date(Date.now(), "YYYY") %> <%= config.title %>
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;<%= config.author %>
        </div> -->
        <div>
            网站已运行: <span id="runTime">1年1天</span>
            <!-- Based on the <a href="https://hexo.io">Hexo Engine</a> &amp;
            <a href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a> -->
        </div>
        <% if (theme.footer.ICP.enable) { %>
            <div>
                备案号：
                <% if (theme.footer.ICP.link) { %>
                    <a href="<%- url_for(theme.footer.ICP.link) %>">
                        <%= theme.footer.ICP.code %>
                    </a>
                    <% } else { %>
                        <%= theme.footer.ICP.code %>
                            <% } %>
            </div>
            <% } %>
    </div>
</footer>